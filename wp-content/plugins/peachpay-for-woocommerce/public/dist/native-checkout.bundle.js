(()=>{var t={5449:function(t,e,n){!function(t){"use strict";var e,n=function(){try{if(t.URLSearchParams&&"bar"===new t.URLSearchParams("foo=bar").get("foo"))return t.URLSearchParams}catch(t){}return null}(),r=n&&"a=1"===new n({a:1}).toString(),a=n&&"+"===new n("s=%2B").get("s"),i=!n||((e=new n).append("s"," &"),"s=+%26"===e.toString()),o=l.prototype,s=!(!t.Symbol||!t.Symbol.iterator);if(!(n&&r&&a&&i)){var c;o.append=function(t,e){f(this.__URLSearchParams__,t,e)},o.delete=function(t){delete this.__URLSearchParams__[t]},o.get=function(t){var e=this.__URLSearchParams__;return this.has(t)?e[t][0]:null},o.getAll=function(t){var e=this.__URLSearchParams__;return this.has(t)?e[t].slice(0):[]},o.has=function(t){return _(this.__URLSearchParams__,t)},o.set=function(t,e){this.__URLSearchParams__[t]=[""+e]},o.toString=function(){var t,e,n,r,a=this.__URLSearchParams__,i=[];for(e in a)for(n=d(e),t=0,r=a[e];t<r.length;t++)i.push(n+"="+d(r[t]));return i.join("&")},!!a&&n&&!r&&t.Proxy?(c=new Proxy(n,{construct:function(t,e){return new t(new l(e[0]).toString())}})).toString=Function.prototype.toString.bind(l):c=l,Object.defineProperty(t,"URLSearchParams",{value:c});var u=t.URLSearchParams.prototype;u.polyfill=!0,u.forEach=u.forEach||function(t,e){var n=y(this.toString());Object.getOwnPropertyNames(n).forEach((function(r){n[r].forEach((function(n){t.call(e,n,r,this)}),this)}),this)},u.sort=u.sort||function(){var t,e,n,r=y(this.toString()),a=[];for(t in r)a.push(t);for(a.sort(),e=0;e<a.length;e++)this.delete(a[e]);for(e=0;e<a.length;e++){var i=a[e],o=r[i];for(n=0;n<o.length;n++)this.append(i,o[n])}},u.keys=u.keys||function(){var t=[];return this.forEach((function(e,n){t.push(n)})),h(t)},u.values=u.values||function(){var t=[];return this.forEach((function(e){t.push(e)})),h(t)},u.entries=u.entries||function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),h(t)},s&&(u[t.Symbol.iterator]=u[t.Symbol.iterator]||u.entries)}function l(t){((t=t||"")instanceof URLSearchParams||t instanceof l)&&(t=t.toString()),this.__URLSearchParams__=y(t)}function d(t){var e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'\(\)~]|%20|%00/g,(function(t){return e[t]}))}function p(t){return t.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(t){return decodeURIComponent(t)}))}function h(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return s&&(n[t.Symbol.iterator]=function(){return n}),n}function y(t){var e={};if("object"==typeof t)if(m(t))for(var n=0;n<t.length;n++){var r=t[n];if(!m(r)||2!==r.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");f(e,r[0],r[1])}else for(var a in t)t.hasOwnProperty(a)&&f(e,a,t[a]);else{0===t.indexOf("?")&&(t=t.slice(1));for(var i=t.split("&"),o=0;o<i.length;o++){var s=i[o],c=s.indexOf("=");-1<c?f(e,p(s.slice(0,c)),p(s.slice(c+1))):s&&f(e,p(s),"")}}return e}function f(t,e,n){var r="string"==typeof n?n:null!=n&&"function"==typeof n.toString?n.toString():JSON.stringify(n);_(t,e)?t[e].push(r):t[e]=[r]}function m(t){return!!t&&"[object Array]"===Object.prototype.toString.call(t)}function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(void 0!==n.g?n.g:"undefined"!=typeof window?window:this)}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";n(5449);var t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==t&&t,e="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,o="ArrayBuffer"in t;if(o)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(t){return t&&s.indexOf(Object.prototype.toString.call(t))>-1};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function f(t){var e=new FileReader,n=y(e);return e.readAsArrayBuffer(t),n}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(t){var n;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:a&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:e&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o&&a&&((n=t)&&DataView.prototype.isPrototypeOf(n))?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(t)||c(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=h(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(f)}),this.text=function(){var t,e,n,r=h(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=y(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(t,e){t=u(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},p.prototype.delete=function(t){delete this.map[u(t)]},p.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},p.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},p.prototype.set=function(t,e){this.map[u(t)]=l(e)},p.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},p.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),d(t)},p.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),d(t)},p.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),d(t)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,a=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new p(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,a||null==t._bodyInit||(a=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new p(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),v.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(a),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function g(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),a=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(a))}})),e}function w(t,e){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new p(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},_.call(b.prototype),_.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];w.redirect=function(t,e){if(-1===k.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})};var S=t.DOMException;try{new S}catch(t){(S=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function E(e,n){return new Promise((function(r,i){var s=new b(e,n);if(s.signal&&s.signal.aborted)return i(new S("Aborted","AbortError"));var c=new XMLHttpRequest;function u(){c.abort()}c.onload=function(){var t,e,n={status:c.status,statusText:c.statusText,headers:(t=c.getAllResponseHeaders()||"",e=new p,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var a=n.join(":").trim();e.append(r,a)}})),e)};n.url="responseURL"in c?c.responseURL:n.headers.get("X-Request-URL");var a="response"in c?c.response:c.responseText;setTimeout((function(){r(new w(a,n))}),0)},c.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},c.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},c.onabort=function(){setTimeout((function(){i(new S("Aborted","AbortError"))}),0)},c.open(s.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(s.url),!0),"include"===s.credentials?c.withCredentials=!0:"omit"===s.credentials&&(c.withCredentials=!1),"responseType"in c&&(a?c.responseType="blob":o&&s.headers.get("Content-Type")&&-1!==s.headers.get("Content-Type").indexOf("application/octet-stream")&&(c.responseType="arraybuffer")),!n||"object"!=typeof n.headers||n.headers instanceof p?s.headers.forEach((function(t,e){c.setRequestHeader(e,t)})):Object.getOwnPropertyNames(n.headers).forEach((function(t){c.setRequestHeader(t,l(n.headers[t]))})),s.signal&&(s.signal.addEventListener("abort",u),c.onreadystatechange=function(){4===c.readyState&&s.signal.removeEventListener("abort",u)}),c.send(void 0===s._bodyInit?null:s._bodyInit)}))}E.polyfill=!0,t.fetch||(t.fetch=E,t.Headers=p,t.Request=b,t.Response=w)})(),(()=>{"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},n.apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;function i(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,a,i=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(t){a={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o}Object.create;var s="PP_SESSION_KEY";function c(){var t,e;return{key:"session_".concat((t=(new Date).getTime(),e=(null===performance||void 0===performance?void 0:performance.now)&&1e3*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var r=16*Math.random();return t>0?(r=(t+r)%16|0,t=Math.floor(t/16)):(r=(e+r)%16|0,e=Math.floor(e/16)),("x"===n?r:7&r|8).toString(16)})))),created_on:(new Date).toJSON()}}function u(){return function(t){if(!t)return c();var e=JSON.parse(t),n=new Date,r=new Date(e.created_on);return n.getMilliseconds()-r.getMilliseconds()>432e6?c():e}(function(){try{return sessionStorage.getItem(s)}catch(t){return null}}())}function l(){!function(t){try{sessionStorage.setItem(s,JSON.stringify(t))}catch(t){return!1}}(u())}function d(){return u().key}function p(t,e){void 0===e&&(e=null);var n=document.querySelector(t);return n&&null!==e&&e(n),n}function h(t,e){var n,r,a=Array.from(document.querySelectorAll(t));if(e)try{for(var o=i(a),s=o.next();!s.done;s=o.next()){e(s.value)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function y(t,e){void 0===e&&(e="a");var n=document.createElement("div");return n.innerHTML=t,e&&n.querySelectorAll(e).forEach((function(t){t.remove()})),n.textContent||n.innerText||""}function f(t,e){return r(this,void 0,void 0,(function(){var n,r;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,fetch(t.plugin.api_url_base+"api/v1/transaction/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:{id:d(),merchant_id:t.merchant.id,merchant_name:t.merchant.name,merchant_url:t.merchant.domain,plugin_version:t.plugin.version,platform:"woocommerce"},transaction:{transaction_location:"checkout-page",payment_method:e,payment_method_variation:null}})})];case 1:return[4,(n=a.sent()).json()];case 2:return r=a.sent(),n.ok&&r.success?[2,r.data.transaction_id]:[2,null];case 3:return a.sent(),[2,null];case 4:return[2]}}))}))}function m(t,e,n){return r(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),r=t.plugin.api_url_base+"api/v1/transaction/update",i=JSON.stringify({session:{id:d(),merchant_id:t.merchant.id,merchant_name:t.merchant.name,merchant_url:t.merchant.domain,plugin_version:t.plugin.version},transaction:{id:e,note:n.note},order:{payment_status:n.paymentStatus,order_status:n.orderStatus}}),[4,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:i})];case 1:return[4,(o=a.sent()).json()];case 2:return s=a.sent(),o.ok&&s.success?[2,!0]:[2,!1];case 3:return a.sent(),[2,!1];case 4:return[2]}}))}))}function _(t,e,n){var r=document.createElement("input");r.type="hidden",r.name="peachpay_transaction_id",r.value=e,t.insertAdjacentElement("beforeend",r);var a=document.createElement("input");a.type="hidden",a.name="peachpay_session_id",a.value=n,t.insertAdjacentElement("beforeend",a)}function v(){h('input[name="peachpay_transaction_id"]',(function(t){t.remove()})),h('input[name="peachpay_session_id"]',(function(t){t.remove()}))}function b(){var t;return null!==(t=document.querySelector("form.checkout"))&&void 0!==t?t:document.querySelector("#order_review")}function g(t){var e=this;jQuery(document.body).on("updated_checkout",(function(){return r(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,t()];case 1:return e.sent(),[2]}}))}))}))}function w(t){return r(this,void 0,void 0,(function(){var e,n,i,o=this;return a(this,(function(s){switch(s.label){case 0:return(e=b())?(n=new FormData(e),i=n.get("payment_method"),[4,t(i)]):[2];case 1:return s.sent(),P((function(){return r(o,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return(e=b())?(n=new FormData(e),r=n.get("payment_method"),[4,t(r)]):[2];case 1:return a.sent(),[2]}}))}))})),[2]}}))}))}function k(t,e){var n=this;jQuery(t).on("click",(function(i){return r(n,void 0,void 0,(function(){var n,r,o,s;return a(this,(function(a){switch(a.label){case 0:if(!jQuery(i.target).closest("#place_order").length)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),n=new FormData(t),(r=n.get("payment_method"))&&e[r]?(jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.preventDefault(),i.stopPropagation(),[4,null===(s=null==e?void 0:e[r])||void 0===s?void 0:s.call(e,t,r)]):[2];case 2:return a.sent()?jQuery(t).trigger("submit"):(jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock()),[3,4];case 3:return o=a.sent(),console.error(o),jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock(),[3,4];case 4:return[2]}}))}))}))}function S(t){return r(this,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e,n){var r=null,a=null,i=function(){r&&window.removeEventListener("hashchange",r,!1),a&&jQuery(document.body).off("checkout_error",a)};r=function(){var r=o(location.hash.split("="),2),a=r[0],s=r[1];if("#payment_data"!==a||!s)return i(),void n(new Error("Invalid url hash payment data: "+location.hash));var c=JSON.parse(atob(decodeURIComponent(s)));c.type===t?(history.replaceState("",document.title,window.location.pathname+window.location.search),i(),e(c)):n(new Error("Invalid url hash payment data type. Expected: "+t+" but got: "+c.type))},a=function(){i(),n(E().join("\n"))},window.addEventListener("hashchange",r,!1),jQuery(document.body).on("checkout_error",a);var s=b();s?jQuery(s).trigger("submit"):n(new Error("Unable to locate checkout form for submission."))}))]}))}))}function E(){var t,e,n=[],r=p("ul.woocommerce-error");if(r)try{for(var a=i(Array.from(r.querySelectorAll("li"))),o=a.next();!o.done;o=a.next()){var s=o.value;n.push(y(s.innerHTML).trim())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return n}function x(t,e,n){var i=this;jQuery(document.body).on("checkout_error",(function(){return r(i,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return r=function(){var t,e;return null!==(e=null===(t=p('input[name="peachpay_transaction_id"]'))||void 0===t?void 0:t.value)&&void 0!==e?e:null}(),v(),i=new FormData(t),(o=i.get("payment_method"))&&e[o]?[4,n(r,E())]:[2];case 1:return a.sent(),[2]}}))}))}))}function P(t){var e=b();e&&new MutationObserver(t).observe(e,{childList:!0,subtree:!0})}function T(t){return function(){var e=document.querySelector("li.wc_payment_method.payment_method_"+t);e&&e.remove()}}function j(t){var e="wc-".concat(t,"-payment-token"),n=p('input[type="radio"][name="'.concat(e,'"]:checked'));return!!n&&"new"!==n.value}function A(t){return{get:function(){return jQuery('input[name="'.concat(t,'"],select[name="').concat(t,'"]')).val()},set:function(e){jQuery('input[name="'.concat(t,'"],select[name="').concat(t,'"]')).val(e).trigger("change")}}}function L(t){return{get:function(){var e,n;return null!==(n=null===(e=p('input[name="'.concat(t,'"]')))||void 0===e?void 0:e.checked)&&void 0!==n&&n},set:function(e){p('input[name="'.concat(t,'"]'),(function(t){t.checked=e}))}}}function F(t){return{get:function(){return L("ship_to_different_address").get()?A("shipping_".concat(t)).get():A("billing_".concat(t)).get()},set:function(e){L("ship_to_different_address").get()?A("shipping_".concat(t)).set(e):A("billing_".concat(t)).set(e)}}}var I={billing:{email:A("billing_email"),phone:A("billing_phone"),firstName:A("billing_first_name"),lastName:A("billing_last_name"),address1:A("billing_address_1"),address2:A("billing_address_2"),city:A("billing_city"),state:A("billing_state"),postcode:A("billing_postcode"),country:A("billing_country")},differentShippingAddress:L("ship_to_different_address"),shipping:{email:F("email"),phone:F("phone"),firstName:F("first_name"),lastName:F("last_name"),address1:F("address_1"),address2:F("address_2"),city:F("city"),state:F("state"),postcode:F("postcode"),country:F("country")}},O=function(t){var e,n;return null!==(n=null===(e=peachpay_checkout_data.plugin.feature_support[t])||void 0===e?void 0:e.enabled)&&void 0!==n&&n},C=function(t,e,n){var r,a;return void 0===n&&(n=null),null!==(a=null===(r=peachpay_checkout_data.plugin.feature_support[t])||void 0===r?void 0:r.metadata[e])&&void 0!==a?a:n};function q(t){return r(this,void 0,void 0,(function(){var e,n,i,o,s,c,u=this;return a(this,(function(l){switch(l.label){case 0:return O("peachpay_square_gateways")&&window.Square?(e=C("peachpay_square_gateways","application_id"),n=C("peachpay_square_gateways","location_id"),e&&n?(i=window.Square.payments(e,n),o=function(t){var e=function(){var t,e;if(peachpay_checkout_data.page.is_order_pay){var n=peachpay_checkout_data.order_pay_details;return{countryCode:null!==(t=C("peachpay_square_gateways","country"))&&void 0!==t?t:"US",currencyCode:null==n?void 0:n.currency,discounts:n.discount_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),lineItems:n.item_lines.map((function(t){return{id:t.id,label:t.label,amount:Number(t.total).toFixed(2)}})),taxLineItems:n.tax_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),total:{label:n.total_line.label,amount:Number(n.total_line.amount).toFixed(2)}}}return{countryCode:null!==(e=C("peachpay_square_gateways","country"))&&void 0!==e?e:"US",currencyCode:peachpay_checkout_data.cart_details.currency,discounts:peachpay_checkout_data.cart_details.discount_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),lineItems:peachpay_checkout_data.cart_details.item_lines.map((function(t){return{id:t.id,label:t.label,amount:Number(t.amount).toFixed(2)}})),taxLineItems:peachpay_checkout_data.cart_details.tax_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),total:{label:peachpay_checkout_data.cart_details.total_line.label,amount:Number(peachpay_checkout_data.cart_details.total_line.amount).toFixed(2)}}},n=t.paymentRequest(e());return g((function(){n.update(e())})),n}(i),c={},[4,B(i)]):[2]):[2];case 1:return c.peachpay_square_card=l.sent(),[4,D(i,o)];case 2:return c.peachpay_square_applepay=l.sent(),[4,$(i,o)];case 3:return c.peachpay_square_googlepay=l.sent(),k(t,s=c),x(t,s,(function(t,e){return r(u,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:if(N(),!t)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m(peachpay_checkout_data,t,{paymentStatus:"unperformed",orderStatus:"creationfailed",note:e.join(" ")})];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}}))}))})),[2]}}))}))}function N(){h('input[name="peachpay_square_source_id"]',(function(t){t.remove()})),h('input[name="peachpay_square_verification_id"]',(function(t){t.remove()}))}function M(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}}function R(){var t,e,n,r,a,i,o,s,c,u,l,d,h,y,f,m,_,v,b,g,w,k={addressLines:[null!==(e=null===(t=p('[name="billing_address_1"]'))||void 0===t?void 0:t.value)&&void 0!==e?e:"",null!==(r=null===(n=p('[name="billing_address_2"]'))||void 0===n?void 0:n.value)&&void 0!==r?r:""],email:null!==(i=null===(a=p('[name="billing_email"]'))||void 0===a?void 0:a.value)&&void 0!==i?i:"",familyName:null!==(s=null===(o=p('[name="billing_last_name"]'))||void 0===o?void 0:o.value)&&void 0!==s?s:"",givenName:null!==(u=null===(c=p('[name="billing_first_name"]'))||void 0===c?void 0:c.value)&&void 0!==u?u:"",city:null!==(d=null===(l=p('[name="billing_city"]'))||void 0===l?void 0:l.value)&&void 0!==d?d:"",countryCode:null!==(f=null!==(y=null===(h=p('[name="billing_country"]'))||void 0===h?void 0:h.value)&&void 0!==y?y:C("peachpay_square_gateways","country"))&&void 0!==f?f:"",phone:null!==(_=null===(m=p('[name="billing_phone"]'))||void 0===m?void 0:m.value)&&void 0!==_?_:"",state:null!==(b=null===(v=p('[name="billing_state"]'))||void 0===v?void 0:v.value)&&void 0!==b?b:"",postalCode:null!==(w=null===(g=p('[name="billing_postcode"]'))||void 0===g?void 0:g.value)&&void 0!==w?w:""};return Number(peachpay_checkout_data.cart_details.total_line.amount)>0?{intent:"CHARGE",amount:Number(peachpay_checkout_data.cart_details.total_line.amount).toFixed(2),currencyCode:peachpay_checkout_data.cart_details.currency,billingContact:k}:{intent:"STORE",billingContact:k}}function z(t){var e=function(){var e,n="";return null===(e=null==t?void 0:t.errors)||void 0===e||e.forEach((function(t){n+=t.message+". "})),n}();switch(M(e),t.status){case"OK":return t.token?[t.token,null,{}]:[null,null,{}];case"Cancel":return[null,null,{paymentStatus:"canceled",note:"Customer canceled the payment."}];case"Abort":return[null,null,{paymentStatus:"creationfailed",note:'Tokenize status "Abort": '+e}];case"Error":case"Invalid":return[null,null,{paymentStatus:"creationfailed",note:e}];default:return[null,null,{paymentStatus:"creationfailed",note:'Tokenize status "Unknown": '+e}]}}function U(t){return r(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){return[2,function(n,i){return r(e,void 0,void 0,(function(){var e,r,s,c,u;return a(this,(function(a){switch(a.label){case 0:return v(),N(),[4,f(peachpay_checkout_data,i)];case 1:return(e=a.sent())?j(i)?[3,5]:[4,t()]:[2,!1];case 2:return r=o.apply(void 0,[a.sent(),3]),s=r[0],c=r[1],u=r[2],s?[3,4]:[4,m(peachpay_checkout_data,e,u)];case 3:return a.sent(),[2,!1];case 4:!function(t,e,n){if(e){var r=document.createElement("input");r.type="hidden",r.name="peachpay_square_source_id",r.value=e,t.insertAdjacentElement("beforeend",r)}if(n){var a=document.createElement("input");a.type="hidden",a.name="peachpay_square_verification_id",a.value=n,t.insertAdjacentElement("beforeend",a)}}(n,s,c),a.label=5;case 5:return _(n,e,d()),[2,!0]}}))}))}]}))}))}function B(t){return r(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(i){switch(i.label){case 0:return[4,t.card()];case 1:return e=i.sent(),P((function(){return r(n,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:if(!(t=p("#pp-square-card-element")))return[2];if(""!==t.innerHTML)return[3,6];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.detach()];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[4,e.attach(t)];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))})),[2,U((function(){return r(n,void 0,void 0,(function(){var n,r,i,s,c,u,l,d,p;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),s=z,[4,e.tokenize()];case 1:return n=o.apply(void 0,[s.apply(void 0,[a.sent()]),3]),r=n[0],n[1],i=n[2],r?[4,t.verifyBuyer(r,R())]:[2,[null,null,i]];case 2:return c=a.sent(),u=null!==(p=null==c?void 0:c.token)&&void 0!==p?p:null,[2,[r,u,i]];case 3:return l=a.sent(),M(d="Sorry something went wrong. Please refresh the page and try again."),l instanceof Error?[2,[null,null,{note:l.message}]]:[2,[null,null,{note:d}]];case 4:return[2]}}))}))}))]}}))}))}function D(t,e){return r(this,void 0,void 0,(function(){var n,i=this;return a(this,(function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.applePay(e)];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),P(T("peachpay_SQUARE_APPLEPAY_GATEWAY")),[3,4];case 4:return[2,U((function(){return r(i,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=z,[4,n.tokenize()];case 1:return[2,t.apply(void 0,[e.sent()])]}}))}))}))]}}))}))}function $(t,e){return r(this,void 0,void 0,(function(){var n,i=this;return a(this,(function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.googlePay(e)];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),P(T("peachpay_square_googlepay")),[3,4];case 4:return[2,U((function(){return r(i,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=z,[4,n.tokenize()];case 1:return[2,t.apply(void 0,[e.sent()])]}}))}))}))]}}))}))}var H="https://js.stripe.com/v3",Q=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,G="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",J=null,X=function(t){return null!==J||(J=new Promise((function(e,n){if("undefined"!=typeof window)if(window.Stripe&&t&&console.warn(G),window.Stripe)e(window.Stripe);else try{var r=function(){for(var t=document.querySelectorAll('script[src^="'.concat(H,'"]')),e=0;e<t.length;e++){var n=t[e];if(Q.test(n.src))return n}return null}();r&&t?console.warn(G):r||(r=function(t){var e=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(H).concat(e);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(t)),r.addEventListener("load",(function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(t){return void n(t)}else e(null)}))),J},V=function(t,e,n){if(null===t)return null;var r=t.apply(void 0,e);return function(t,e){t&&t._registerWrapper&&t._registerWrapper({name:"stripe-js",version:"1.44.1",startTime:e})}(r,n),r},W=Promise.resolve().then((function(){return X(null)})),K=!1;W.catch((function(t){K||console.warn(t)}));var Y=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];K=!0;var r=Date.now();return W.then((function(t){return V(t,e,r)}))},Z=function(){function t(t,e){this.stripe=t,this.elements=e}return t.prototype.init=function(){},t.prototype.displayPaymentError=function(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}},t}(),tt=function(){function t(t){this.mounted=!1;var e={base:{color:"#333",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#6a6a6a"}}};this.$cardNumber=t.create("cardNumber",{style:e,placeholder:"Card number"}),this.$cardExpiry=t.create("cardExpiry",{style:e}),this.$cardCvc=t.create("cardCvc",{style:e,placeholder:"CVV"}),this.init()}return t.prototype.mount=function(){var t=this;if(!this.mounted){this.mounted=!0,P((function(){var e=p("#pp-stripe-card-element");if(e&&0!==Array.from(e.querySelectorAll('[class="loading-blur"]')).length){var n=p("#pp-stripe-card-number"),r=p("#pp-stripe-card-expiry"),a=p("#pp-stripe-card-cvc");n&&r&&a&&(n.innerHTML="",r.innerHTML="",a.innerHTML="",t.$cardNumber.mount(n),t.$cardExpiry.mount(r),t.$cardCvc.mount(a))}}));var e=p("#pp-stripe-card-number"),n=p("#pp-stripe-card-expiry"),r=p("#pp-stripe-card-cvc");e&&n&&r&&(e.innerHTML="",n.innerHTML="",r.innerHTML="",this.$cardNumber.mount(e),this.$cardExpiry.mount(n),this.$cardCvc.mount(r))}},t.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,t.createPaymentMethod({type:"card",card:this.$cardNumber,billing_details:St()})];case 1:if(n=a.sent(),r=n.paymentMethod,i=n.error){switch(i.code){case"incomplete_cvc":case"invalid_cvc":this.$cardCvc.focus();break;case"incomplete_expiry":case"invalid_expiry_year_past":this.$cardExpiry.focus();break;default:this.$cardNumber.focus()}return o=null!==(e=i.message)&&void 0!==e?e:"",setTimeout((function(){!function(t,e){"error"===e?(p("#pp-stripe-card-element",(function(t){t.classList.add("error")})),p("#pp-stripe-card-status",(function(t){t.classList.add("show"),t.classList.add("error")}))):p("#pp-stripe-card-status",(function(t){t.classList.add("show")}));p("#pp-stripe-card-status span",(function(e){e.innerHTML=t}))}(o,"error")}),10),[2,[null,{note:o}]]}return(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{note:"Failed to tokenize payment method."}]]}}))}))},t.prototype.init=function(){this.$cardNumber.on("focus",et("Enter your card number.")),this.$cardNumber.on("change",rt("Enter your card number.",this.$cardExpiry.focus)),this.$cardNumber.on("change",(function(t){p("#pp-stripe-card-brand img",(function(e){e.src="".concat(peachpay_checkout_data.plugin.asset_url_base,"/img/marks/").concat((null==t?void 0:t.brand)&&"unknown"!==t.brand?t.brand:"credit-card-regular",".svg")}))})),this.$cardNumber.on("blur",nt()),this.$cardExpiry.on("focus",et("Enter the expiration date.")),this.$cardExpiry.on("change",rt("Enter the expiration date.",this.$cardCvc.focus)),this.$cardExpiry.on("blur",nt()),this.$cardCvc.on("focus",et("Enter the security code.")),this.$cardCvc.on("change",rt("Enter the security code.")),this.$cardCvc.on("blur",nt())},t}();function et(t){return function(){p("#pp-stripe-card-element",(function(t){t.classList.add("focused")})),p("#pp-stripe-card-status",(function(t){t.classList.add("show")})),p("#pp-stripe-card-status span",(function(e){e.innerHTML=t}))}}function nt(){return function(){p("#pp-stripe-card-element",(function(t){t.classList.remove("focused"),t.classList.remove("error")})),p("#pp-stripe-card-status",(function(t){t.classList.remove("show"),t.classList.remove("error")})),p("#pp-stripe-card-status span",(function(t){t.innerHTML=""}))}}function rt(t,e){return function(n){p("#pp-stripe-card-element",(function(t){t.classList.remove("error")})),p("#pp-stripe-card-status",(function(t){t.classList.remove("error")})),n.error?(p("#pp-stripe-card-element",(function(t){t.classList.add("error")})),p("#pp-stripe-card-status",(function(t){t.classList.add("show"),t.classList.add("error")})),p("#pp-stripe-card-status span",(function(t){var e,r;t.innerHTML=null!==(r=null===(e=n.error)||void 0===e?void 0:e.message)&&void 0!==r?r:""}))):n.complete?(p("#pp-stripe-card-status",(function(t){t.classList.remove("show")})),p("#pp-stripe-card-status span",(function(t){t.innerHTML=""})),null==e||e()):(p("#pp-stripe-card-status",(function(t){t.classList.add("show")})),p("#pp-stripe-card-status span",(function(e){e.innerHTML=t})))}}function at(t,e,n){return r(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return r=C("peachpay_stripe_gateways","setup_intent_url"),i=C("peachpay_stripe_gateways","setup_intent_nonce"),r&&i?((o=new FormData).append("security",i),o.append("session_id",t),o.append("payment_method_type",e),n&&o.append("payment_method",n),[4,fetch(r,{method:"POST",body:o})]):[2,null];case 1:return[4,a.sent().json()];case 2:return(s=a.sent()).success?[2,s.data.setup_intent_details.client_secret]:[2,null]}}))}))}var it=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.$cardElement=new tt(r.elements),r}return e(n,t),n.prototype.init=function(){this.$cardElement.mount()},n.prototype.gatewayId=function(){return"peachpay_stripe_card"},n.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i,s,c,u,l;return a(this,(function(a){switch(a.label){case 0:return[4,this.$cardElement.tokenize(this.stripe)];case 1:return n=o.apply(void 0,[a.sent(),2]),r=n[0],i=n[1],r?(peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details?peachpay_checkout_data.order_pay_details:peachpay_checkout_data.cart_details).is_only_free_trial?[4,at(t,"card",r)]:[2,[r,{}]]:[2,[null,i]];case 2:return(s=a.sent())?[4,this.stripe.confirmCardSetup(s)]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 3:return c=a.sent(),u=c.error,!(l=c.setupIntent)||u?[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==u?void 0:u.message)&&void 0!==e?e:"Failed to confirm setup intent."}]]:"succeeded"!==l.status?[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(l.status,")")}]]:[2,[l.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e,n;return r(this,void 0,void 0,(function(){var r,i,o,s,c,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return r=a.sent(),i=r.paymentIntent,o=r.error,!i||o?[2,[null,{note:null!==(e=null==o?void 0:o.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===i.status||"requires_capture"===i.status?[2,["success",{}]]:"requires_action"!==i.status?[3,3]:[4,this.stripe.confirmCardPayment(t)];case 2:if(s=a.sent(),c=s.paymentIntent,u=s.error,!c||u)return[2,[null,{note:null!==(n=null==u?void 0:u.message)&&void 0!==n?n:"Failed to confirm payment intent."}]];if("succeeded"===c.status)return[2,["success",{}]];a.label=3;case 3:return[2,[null,{note:"Failed to confirm payment intent with status(".concat(i.status,")")}]]}}))}))},n}(Z),ot=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_bancontact"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=St(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"bancontact",billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmBancontactPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),st=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_giropay"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=St(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name),[4,this.stripe.createPaymentMethod({type:"giropay",billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmGiropayPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),ct=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_affirm"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"affirm",billing_details:St()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmAffirmPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),ut=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.gatewayId=function(){return"peachpay_stripe_sofort"},i.prototype.tokenize=function(){var t,e;return r(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return r={sofort:{country:I.billing.country.get()},billing_details:St()},peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(r.billing_details.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,r.billing_details.email=peachpay_checkout_data.order_pay_details.billing_email,r.sofort.country=null!==(t=peachpay_checkout_data.order_pay_details.billing_country)&&void 0!==t?t:""),[4,this.stripe.createPaymentMethod(n({type:"sofort"},r))];case 1:return i=a.sent(),o=i.paymentMethod,(s=i.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(e=s.message)&&void 0!==e?e:"Failed to tokenize payment method."}]]:(null==o?void 0:o.id)?[2,[o.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},i.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmSofortPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},i}(Z),lt=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$epsElement=n.create("epsBank",{}),g((function(){try{r.$epsElement.mount("#pp-eps-element")}catch(t){}}));try{r.$epsElement.mount("#pp-eps-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_eps"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=St(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name),[4,this.stripe.createPaymentMethod({type:"eps",eps:this.$epsElement,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmEpsPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),dt=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$p24Element=n.create("p24Bank",{}),g((function(){try{r.$p24Element.mount("#pp-p24-element")}catch(t){}}));try{r.$p24Element.mount("#pp-p24-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_p24"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=St(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"p24",p24:this.$p24Element,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmP24Payment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),pt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_klarna"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"klarna",billing_details:St()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmKlarnaPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),ht=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_afterpay"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"afterpay_clearpay",billing_details:St()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmAfterpayClearpayPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),yt=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$idealElement=n.create("idealBank"),g((function(){try{r.$idealElement.mount("#pp-stripe-ideal-element")}catch(t){}}));try{r.$idealElement.mount("#pp-stripe-ideal-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_ideal"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=St(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"ideal",ideal:this.$idealElement,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Payment failed to tokenize."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmIdealPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(Z),ft=["BIF","CLP","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","UGX","VND","VUV","XAF","XOF","XPF"];function mt(t,e){var n=Number.parseFloat(t);return ft.includes(e)||(n*=100),Math.round(n)}var _t=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.paymentRequest=null,g((function(){var t;null===(t=r.paymentRequest)||void 0===t||t.update({currency:peachpay_checkout_data.cart_details.currency.toLowerCase(),total:{label:peachpay_checkout_data.cart_details.total_line.label,amount:mt(peachpay_checkout_data.cart_details.total_line.amount,peachpay_checkout_data.cart_details.currency)},displayItems:peachpay_checkout_data.cart_details.item_lines.map((function(t){return{label:t.label,amount:mt(t.amount,peachpay_checkout_data.cart_details.currency)}}))})})),r}return e(n,t),n.tokenizePaymentRequest=function(t){return new Promise((function(e){null==t||t.on("paymentmethod",(function(n){t=null,n.complete("success"),e([n.paymentMethod.id,{}])})),null==t||t.on("cancel",(function(){t=null,e([null,{note:"Payment was canceled by customer"}])})),null==t||t.show()}))},n.prototype.init=function(t){return void 0===t&&(t=!0),r(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.paymentRequest=this.stripe.paymentRequest(function(){var t,e;return e=peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details?peachpay_checkout_data.order_pay_details:peachpay_checkout_data.cart_details,{country:null!==(t=C("peachpay_stripe_gateways","country"))&&void 0!==t?t:"US",currency:e.currency.toLowerCase(),total:{label:e.total_line.label,amount:mt(e.total_line.amount,e.currency)},displayItems:e.item_lines.map((function(t){return{label:t.label,amount:mt(t.amount,e.currency)}}))}}()),[4,this.paymentRequest.canMakePayment()];case 1:return e=r.sent(),"googlepay"===this.paymentRequestType()&&!(null==e?void 0:e.googlePay)&&t||"applepay"===this.paymentRequestType()&&!(null==e?void 0:e.applePay)&&t?(P(T(this.gatewayId())),T(this.gatewayId())(),[2]):[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}}))}))},n.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var r,i,s,c,u,l,d,p;return a(this,(function(a){switch(a.label){case 0:return this.paymentRequest?[3,2]:[4,this.init(!1)];case 1:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method because paymentRequest object is not initialized."}]];case 2:return r=this.paymentRequest,this.paymentRequest=null,[4,n.tokenizePaymentRequest(r)];case 3:return i=o.apply(void 0,[a.sent(),2]),s=i[0],c=i[1],s?[3,5]:[4,this.init(!1)];case 4:return a.sent(),[2,[null,c]];case 5:return[4,at(t,"card",s)];case 6:return(u=a.sent())?[3,8]:[4,this.init(!1)];case 7:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 8:return[4,this.stripe.confirmCardSetup(u)];case 9:return l=a.sent(),d=l.error,(p=l.setupIntent)&&!d?[3,11]:[4,this.init(!1)];case 10:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==d?void 0:d.message)&&void 0!==e?e:"Failed to confirm setup intent."}]];case 11:return"succeeded"===p.status?[3,13]:[4,this.init(!1)];case 12:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(p.status,")")}]];case 13:return[4,this.init(!1)];case 14:return a.sent(),[2,[p.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return n=a.sent(),r=n.paymentIntent,i=n.error,!r||i?[2,[null,{note:null!==(e=null==i?void 0:i.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===r.status||"requires_capture"===r.status?[2,["success",{}]]:[2,[null,{note:"Failed to confirm payment intent with status(".concat(r.status,")")}]]}}))}))},n}(Z),vt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_googlepay"},n.prototype.paymentRequestType=function(){return"googlepay"},n}(_t),bt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_applepay"},n.prototype.paymentRequestType=function(){return"applepay"},n}(_t),gt=function(){function t(t,e){this.storeName=t,this.customerFullName=e,this.mandateElement=null,this.mandateElementAccept=null,this.mandateElementCancel=null,this.mandateElementX=null}return t.prototype.confirm=function(){return r(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,new Promise((function(e,n){var r,a,i;if(!t.mount())return t.unmount(),void n(new Error("Developer error: Mandate failed to be mounted."));null===(r=t.mandateElementAccept)||void 0===r||r.addEventListener("click",(function(){t.unmount(),e(!0)})),null===(a=t.mandateElementCancel)||void 0===a||a.addEventListener("click",(function(){t.unmount(),e(!1)})),null===(i=t.mandateElementX)||void 0===i||i.addEventListener("click",(function(){t.unmount(),e(!1)}))}))]}))}))},t.prototype.mount=function(){var t=this,e=document.createElement("div");return e.innerHTML=this.renderTemplate(),this.mandateElement=e.querySelector("#ach-mandate-container"),!!this.mandateElement&&(p("body",(function(e){return e.insertAdjacentElement("beforeend",t.mandateElement)})),this.mandateElementAccept=this.mandateElement.querySelector("#ach-button-accept"),!!this.mandateElementAccept&&(this.mandateElementCancel=this.mandateElement.querySelector("#ach-button-cancel"),!!this.mandateElementCancel&&(this.mandateElementX=this.mandateElement.querySelector("#ach-button-x"),!!this.mandateElementX)))},t.prototype.unmount=function(){var t;null===(t=this.mandateElement)||void 0===t||t.remove(),this.mandateElement=null,this.mandateElementAccept=null,this.mandateElementCancel=null,this.mandateElementX=null},t.prototype.renderTemplate=function(){var t=(new Date).toLocaleDateString(),e=null===this.customerFullName?"":"<p>Name: ".concat(this.customerFullName,"</p>");return'\n<div id="ach-mandate-container">\n    <div id="ach-mandate-modal">\n        <div id="ach-mandate-header">\n            <button type="button" id="ach-button-x" class="txt-btn" style="font-size: 2rem;">×</button>\n        </div>\n        <div id="ach-mandate-body">\n            <span>\n                '.concat(e,"\n                <p>Date: ").concat(t,'</p>\n            </span>\n            <br>\n            <p>\n                By clicking <b>Accept</b>, you authorize <span class="client">').concat(this.storeName,'</span> to debit the bank account specified above for any amount owed\n                for charges arising from your use of <span class="client">').concat(this.storeName,'\'s</span> services and/or purchase of products from\n                <span class="client">').concat(this.storeName,'</span>, pursuant to <span class="client">').concat(this.storeName,'\'s</span> website and terms, until this authorization\n                is revoked. You may amend or cancel this authorization at any time by providing notice to <span class="client">').concat(this.storeName,'</span>with 30\n                (thirty) days notice.\n            </p>\n            <br>\n            <div style="text-align: center;">\n                <button type="button" id="ach-button-accept" class="btn" style="padding: 9px; width: 7rem;">Accept</button>\n                <button type="button" id="ach-button-cancel" class="txt-btn">Cancel</button>\n            </div>\n        </div>\n    </div>\n    <style>\n        #ach-mandate-container{\n            position: fixed;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n            background-color: rgba(0,0,0,0.5);\n            animation-name: fadein;\n            animation-duration: 0.4s;\n            z-index: 1000000000000;\n        }\n\n        @keyframes fadein{\n            from {\n                background-color: rgba(0,0,0,0);\n            }\n            to {\n                background-color: rgba(0,0,0,0.5);\n            }\n        }\n\n        #ach-mandate-container .client{\n            border: 1px solid #e6e6e6;\n            border-radius: 0.2rem;\n            background-color: #e6e6e6;\n            padding: 0 4px;\n            margin-bottom: 1px;\n            display: inline-block;\n        }\n\n        #ach-mandate-modal{\n            position: absolute;\n            background-color: white;\n            border-radius: 0.4rem;\n            z-index: 10000000000;\n            width: 50vw;\n            box-shadow:  2px 8px 20px 3px rgb(0 0 0 / 20%);\n            margin: 0 calc(49vw / 2);\n            top: 10vh;\n        }\n\n        #ach-mandate-header{\n            padding: 0 0.5rem;\n            text-align: right;\n            border-bottom: 1px solid #e6e6e6;\n        }\n\n        #ach-mandate-body{\n            padding: 1.5rem;\n        }\n\n        #ach-mandate-body p {\n            margin: 0;\n            padding: 0;\n        }\n        \n        #ach-mandate-modal .txt-btn{\n            border: none;\n            background: none;\n            color: grey;\n            font-weight: 400;\n            padding: 0.1rem 1rem 0.1rem 0 !important;\n        }\n\n        #ach-mandate-modal .txt-btn:hover{\n            cursor: pointer;\n            color: red;\n        } \n\n        @media screen and (max-width: 768px) {\n\n            \n            #ach-mandate-modal{\n                width: 100%;\n                margin: 0;\n                left: 0;\n                right: 0;\n\n                animation-duration: 0.8s;\n                animation-name: slideup;\n                top: unset;\n                bottom: 0;\n                border-bottom-left-radius: 0;\n                border-bottom-right-radius: 0;\n            }\n\n            @keyframes slideup{\n                from {\n                    bottom: -100%\n                }\n                to {\n                    bottom: 0;\n                }\n            }\n\n        }\n\n        /*This prevents the background from being scrollable*/\n        body{\n            overflow: hidden !important;\n            touch-action: none !important;\n        }\n    </style>\n</div>')},t}(),wt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_achdebit"},n.prototype.tokenize=function(t){var e,n;return r(this,void 0,void 0,(function(){var r,i,o,s,c,u,l,d,p,h,y,f;return a(this,(function(a){switch(a.label){case 0:return[4,at(t,"us_bank_account")];case 1:return(r=a.sent())?[4,this.stripe.collectBankAccountForSetup({clientSecret:r,params:{payment_method_type:"us_bank_account",payment_method_data:{billing_details:{name:I.billing.firstName.get()+" "+I.billing.lastName.get()}}}})]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 2:if(i=a.sent(),o=i.error,!(s=i.setupIntent)||o)return[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==o?void 0:o.message)&&void 0!==e?e:"Failed to collect bank account for setup intent."}]];if("requires_confirmation"!==s.status)return[2,[null,{paymentStatus:"creationfailed",note:"The customer canceled choosing a bank account."}]];c=peachpay_checkout_data.merchant.name,u=I.billing.firstName.get()?I.billing.firstName.get()+" "+I.billing.lastName.get():null,l=new gt(c,u),d=!1,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,l.confirm()];case 4:return d=a.sent(),[3,6];case 5:return p=a.sent(),console.error(p),[3,6];case 6:return d?[4,this.stripe.confirmUsBankAccountSetup(r)]:("The required mandate was not accepted. Payment canceled.",[2,[null,{note:"The required mandate was not accepted. Payment canceled."}]]);case 7:return h=a.sent(),y=h.error,!(f=h.setupIntent)||y?[2,[null,{paymentStatus:"creationfailed",note:null!==(n=null==y?void 0:y.message)&&void 0!==n?n:"Failed to confirm setup intent."}]]:"succeeded"!==f.status?[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(f.status,")")}]]:[2,[f.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return n=a.sent(),r=n.paymentIntent,i=n.error,!r||i?[2,[null,{note:null!==(e=null==i?void 0:i.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===r.status||"processing"===r.status?[2,["success",{}]]:[2,[null,{note:"Failed to confirm payment intent with status(".concat(r.status,")")}]]}}))}))},n}(Z);function kt(t){return r(this,void 0,void 0,(function(){var e,n,i,s,c,u=this;return a(this,(function(l){switch(l.label){case 0:return O("peachpay_stripe_gateways")?(e=C("peachpay_stripe_gateways","public_key"),n=C("peachpay_stripe_gateways","connect_id"),e&&n?[4,Y(e,{stripeAccount:n,locale:"auto"})]:[2]):[2];case 1:return(i=l.sent())?(s=i.elements(),c=[],O("peachpay_stripe_card_gateway")&&c.push(new it(i,s)),O("peachpay_stripe_bancontact_gateway")&&c.push(new ot(i,s)),O("peachpay_stripe_giropay_gateway")&&c.push(new st(i,s)),O("peachpay_stripe_affirm_gateway")&&c.push(new ct(i,s)),O("peachpay_stripe_sofort_gateway")&&c.push(new ut(i,s)),O("peachpay_stripe_eps_gateway")&&c.push(new lt(i,s)),O("peachpay_stripe_p24_gateway")&&c.push(new dt(i,s)),O("peachpay_stripe_klarna_gateway")&&c.push(new pt(i,s)),O("peachpay_stripe_afterpay_gateway")&&c.push(new ht(i,s)),O("peachpay_stripe_ideal_gateway")&&c.push(new yt(i,s)),O("peachpay_stripe_googlepay_gateway")&&c.push(new vt(i,s)),O("peachpay_stripe_applepay_gateway")&&c.push(new bt(i,s)),O("peachpay_stripe_achdebit_gateway")&&c.push(new wt(i,s)),[4,Promise.all(c.map((function(t){return t.init()})))]):[2];case 2:return l.sent(),function(t,e,n){var i=this;jQuery(t).on("click",(function(o){return r(i,void 0,void 0,(function(){var r,i,s;return a(this,(function(a){switch(a.label){case 0:if(!jQuery(o.target).closest("#place_order").length)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),r=new FormData(t),(i=r.get("payment_method"))&&e.includes(i)?(jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o.preventDefault(),o.stopPropagation(),[4,n(i)]):[2];case 2:return a.sent()?jQuery(t).trigger("submit"):(jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock()),[3,4];case 3:return s=a.sent(),console.error(s),jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock(),[3,4];case 4:return[2]}}))}))}))}(t,c.map((function(t){return t.gatewayId()})),(function(e){return r(u,void 0,void 0,(function(){var n,r,i,s,u;return a(this,(function(a){switch(a.label){case 0:return(n=c.find((function(t){return t.gatewayId()===e})))?(v(),h('input[name="peachpay_stripe_payment_method_id"]',(function(t){t.remove()})),r=null,j(e)?[4,f(peachpay_checkout_data,e)]:[3,2]):[2,!1];case 1:return(r=a.sent())?[3,7]:[2,!1];case 2:return[4,n.tokenize(d())];case 3:return i=o.apply(void 0,[a.sent(),2]),s=i[0],u=i[1],!s&&(null==u?void 0:u.note)&&n.displayPaymentError(u.note),[4,f(peachpay_checkout_data,e)];case 4:return(r=a.sent())?s?[3,6]:[4,m(peachpay_checkout_data,r,u)]:[2,!1];case 5:return a.sent(),[2,!1];case 6:!function(t,e){if(e){var n=document.createElement("input");n.type="hidden",n.name="peachpay_stripe_payment_method_id",n.value=e,t.insertAdjacentElement("beforeend",n)}}(t,s),a.label=7;case 7:return _(t,r,d()),[2,!0]}}))}))})),p="stripe",y=function(t){return r(u,void 0,void 0,(function(){var e,n,r,i,s;return a(this,(function(a){switch(a.label){case 0:if("stripe"!==t.type)return[2];if(!(e=c.find((function(e){return t.gateway===e.gatewayId()}))))return[2];a.label=1;case 1:return a.trys.push([1,5,,7]),[4,e.confirm(t.data.client_secret,t.intermediate_url)];case 2:return n=o.apply(void 0,[a.sent(),2]),r=n[0],i=n[1],r?[3,4]:[4,m(peachpay_checkout_data,t.transaction_id,i)];case 3:a.sent(),a.label=4;case 4:return"success"===r&&(window.location.href=t.success_url),[3,7];case 5:return s=a.sent(),[4,m(peachpay_checkout_data,t.transaction_id,{note:s.message,paymentStatus:"failed"})];case 6:return a.sent(),[3,7];case 7:return[2]}}))}))},window.addEventListener("hashchange",(function(){var t=o(location.hash.split("="),2),e=t[0],n=t[1];if("#payment_data"===e&&n){var r=JSON.parse(atob(decodeURIComponent(n)));r.type===p&&(history.replaceState("",document.title,window.location.pathname+window.location.search),y(r))}}),!1),[2]}var p,y}))}))}function St(){return I.billing.firstName.get()?{name:"".concat(I.billing.firstName.get()," ").concat(I.billing.lastName.get()),email:I.billing.email.get(),phone:I.billing.phone.get(),address:{city:I.billing.city.get(),country:I.billing.country.get(),line1:I.billing.address1.get(),line2:I.billing.address2.get(),postal_code:I.billing.postcode.get(),state:I.billing.state.get()}}:{}}function Et(t){return r(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(i){return k(t,e={peachpay_purchase_order:xt}),x(t,e,(function(t,e){return r(n,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:if(!t)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m(peachpay_checkout_data,t,{paymentStatus:"unperformed",orderStatus:"creationfailed",note:e.join(" ")})];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}}))}))})),[2]}))}))}function xt(t,e){return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return v(),[4,f(peachpay_checkout_data,e)];case 1:return(n=r.sent())?(_(t,n,d()),[2,!0]):[2,!1]}}))}))}function Pt(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL),function(t){var e=t["merchant-id"],n=t["data-merchant-id"],r="",a="";Array.isArray(e)?e.length>1?(r="*",a=e.toString()):r=e.toString():"string"==typeof e&&e.length>0?r=e:"string"==typeof n&&n.length>0&&(r="*",a=n);t["merchant-id"]=r,t["data-merchant-id"]=a}(t);var n=Object.keys(t).filter((function(e){return void 0!==t[e]&&null!==t[e]&&""!==t[e]})).reduce((function(e,n){var r=t[n].toString();return"data-"===n.substring(0,5)?e.dataAttributes[n]=r:e.queryParams[n]=r,e}),{queryParams:{},dataAttributes:{}}),r=n.queryParams,a=n.dataAttributes;return{url:"".concat(e,"?").concat(Tt(r)),dataAttributes:a}}function Tt(t){var e="";return Object.keys(t).forEach((function(n){0!==e.length&&(e+="&"),e+=n+"="+t[n]})),e}function jt(t,e){void 0===e&&(e={});var n=document.createElement("script");return n.src=t,Object.keys(e).forEach((function(t){n.setAttribute(t,e[t]),"data-csp-nonce"===t&&n.setAttribute("nonce",e["data-csp-nonce"])})),n}function At(t,e){if(void 0===e&&(e=Lt()),It(t,e),"undefined"==typeof window)return e.resolve(null);var n=Pt(t),r=n.url,a=n.dataAttributes,i=a["data-namespace"]||"paypal",o=Ft(i);return function(t,e){var n=document.querySelector('script[src="'.concat(t,'"]'));if(null===n)return null;var r=jt(t,e),a=n.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(r.dataset).length)return null;var i=!0;return Object.keys(a.dataset).forEach((function(t){a.dataset[t]!==r.dataset[t]&&(i=!1)})),i?n:null}(r,a)&&o?e.resolve(o):function(t,e){void 0===e&&(e=Lt());It(t,e);var n=t.url,r=t.attributes;if("string"!=typeof n||0===n.length)throw new Error("Invalid url.");if(void 0!==r&&"object"!=typeof r)throw new Error("Expected attributes to be an object.");return new e((function(t,e){if("undefined"==typeof window)return t();!function(t){var e=t.url,n=t.attributes,r=t.onSuccess,a=t.onError,i=jt(e,n);i.onerror=a,i.onload=r,document.head.insertBefore(i,document.head.firstElementChild)}({url:n,attributes:r,onSuccess:function(){return t()},onError:function(){var t=new Error('The script "'.concat(n,'" failed to load.'));return window.fetch?fetch(n).then((function(n){return 200===n.status&&e(t),n.text()})).then((function(t){var n=function(t){var e=t.split("/* Original Error:")[1];return e?e.replace(/\n/g,"").replace("*/","").trim():t}(t);e(new Error(n))})).catch((function(t){e(t)})):e(t)}})}))}({url:r,attributes:a},e).then((function(){var t=Ft(i);if(t)return t;throw new Error("The window.".concat(i," global variable is not available."))}))}function Lt(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function Ft(t){return window[t]}function It(t,e){if("object"!=typeof t||null===t)throw new Error("Expected an options object.");if(void 0!==e&&"function"!=typeof e)throw new Error("Expected PromisePonyfill to be a function.")}var Ot=function(){function t(){this.paypal=null,this.button=null,this.isEligible=!1,this.isMounted=!1,this.mountContainer=null,this.currentPaymentDetails=null}return t.prototype.init=function(t){var e;this.paypal=t,this.button=this.createButtonComponent(),(null===(e=this.button)||void 0===e?void 0:e.isEligible())?this.isEligible=!0:(P(T(this.gatewayId())),T(this.gatewayId())(),this.isEligible=!1)},t.prototype.mount=function(){var e,n;if(this.paypal&&this.isEligible&&!this.isMounted&&!t.isOpen){if(p("#"+this.gatewayId()+"_button_container")||(this.mountContainer=null,this.button=null),this.button||(this.button=this.createButtonComponent()),this.mountContainer)null===(e=this.mountContainer)||void 0===e||e.classList.remove("hide");else{var r=p(".place-order");if(!r)return void console.error('Could not locate WC "Place order" button container! PayPal gateway "'.concat(this.gatewayId(),'" button not inserted.'));this.mountContainer=document.createElement("div"),this.mountContainer.setAttribute("id",this.gatewayId()+"_button_container"),null==r||r.insertAdjacentElement("beforeend",this.mountContainer),null===(n=this.button)||void 0===n||n.render("#"+this.gatewayId()+"_button_container").catch((function(){}))}this.isMounted=!0}},t.prototype.unmount=function(){var e;t.isOpen||this.isMounted&&(null===(e=this.mountContainer)||void 0===e||e.classList.add("hide"),this.isMounted=!1)},t.prototype.displayPaymentError=function(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])',".peachpay - tokenize - error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay - tokenize - error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}},t.prototype.createButtonComponent=function(){var e,n,i=this.gatewayId(),o=this;return null!==(n=null===(e=this.paypal)||void 0===e?void 0:e.Buttons({fundingSource:this.fundingType(),style:this.buttonStyle(),onClick:function(){t.isOpen=!0},createOrder:function(t,e){return r(this,void 0,void 0,(function(){var t,e,n,r;return a(this,(function(a){switch(a.label){case 0:return(t=b())?[4,f(peachpay_checkout_data,i)]:[2,""];case 1:if(!(e=a.sent()))return[2,""];_(t,e,d()),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,S("paypal")];case 3:return n=a.sent(),o.currentPaymentDetails=n,[2,n.data.id];case 4:return r=a.sent(),console.error(r),jQuery(t).unblock(),[2,""];case 5:return[2]}}))}))},onShippingChange:function(t,e){var n,i;return r(this,void 0,void 0,(function(){var r,s,c,u;return a(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(e){var n,r,a,i,o,s,c,u,l=null;l=function(){jQuery(document.body).off("updated_checkout",l),I.shipping.country.get()?e(!0):e(!1)},jQuery(document.body).on("updated_checkout",l),I.shipping.country.set(null!==(r=null===(n=t.shipping_address)||void 0===n?void 0:n.country_code)&&void 0!==r?r:I.shipping.country.get()),I.shipping.state.set(null!==(i=null===(a=t.shipping_address)||void 0===a?void 0:a.state)&&void 0!==i?i:I.shipping.state.get()),I.shipping.postcode.set(null!==(s=null===(o=t.shipping_address)||void 0===o?void 0:o.postal_code)&&void 0!==s?s:I.shipping.postcode.get()),I.shipping.city.set(null!==(u=null===(c=t.shipping_address)||void 0===c?void 0:c.city)&&void 0!==u?u:I.shipping.city.get()),jQuery(document.body).trigger("update_checkout")}))];case 1:return a.sent()?(r=C("peachpay_paypal_gateways","update_order_url"),s=C("peachpay_paypal_gateways","update_order_security"),r&&s?((c=new FormData).append("security",s),c.append("order_id",null!==(i=null===(n=o.currentPaymentDetails)||void 0===n?void 0:n.order_id)&&void 0!==i?i:""),[4,fetch(r,{method:"POST",body:c})]):(console.error("Missing required dependencies to update PayPal order."),[2,e.reject()])):[2,e.reject()];case 2:return[4,a.sent().json()];case 3:return(u=a.sent()).success?[2,e.resolve()]:(console.error(u.message),[2,e.reject()])}}))}))},onApprove:function(t,e){var n;return r(this,void 0,void 0,(function(){var t,r,i,s;return a(this,(function(a){switch(a.label){case 0:return(null===(n=o.currentPaymentDetails)||void 0===n?void 0:n.order_id)?(t=C("peachpay_paypal_gateways","approve_order_url"),r=C("peachpay_paypal_gateways","approve_order_security"),t&&r?((i=new FormData).append("security",r),i.append("order_id",o.currentPaymentDetails.order_id),[4,fetch(t,{method:"POST",body:i})]):(console.error("Missing required dependencies to Capture/Confirm PayPal order."),e.restart(),[2])):(console.error("Unknown Woocommerce Order"),e.restart(),[2]);case 1:return[4,a.sent().json()];case 2:return(s=a.sent()).success?(e.redirect(o.currentPaymentDetails.success_url),[2]):(console.error(s.message),e.restart(),[2])}}))}))},onCancel:function(t,e){return r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return o.currentPaymentDetails?[4,m(peachpay_checkout_data,o.currentPaymentDetails.transaction_id,{paymentStatus:"CANCELED",orderStatus:"canceled"})]:(console.error(t),[2]);case 1:return e.sent(),window.location.href=o.currentPaymentDetails.cancel_url,[2]}}))}))},onError:function(t){var e;return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return console.error(t),(null===(e=o.currentPaymentDetails)||void 0===e?void 0:e.transaction_id)?[4,m(peachpay_checkout_data,o.currentPaymentDetails.transaction_id,{note:JSON.stringify(t)})]:[3,2];case 1:r.sent(),r.label=2;case 2:return o.currentPaymentDetails=null,(n=b())&&jQuery(n).unblock(),[2]}}))}))}}))&&void 0!==n?n:null},t.isOpen=!1,t}(),Ct=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_venmo"},n.prototype.fundingType=function(){return"venmo"},n.prototype.buttonStyle=function(){var t;return null!==(t=C("peachpay_paypal_venmo_gateway","button_style"))&&void 0!==t?t:void 0},n}(Ot),qt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_wallet"},n.prototype.fundingType=function(){return"paypal"},n.prototype.buttonStyle=function(){var t;return null!==(t=C("peachpay_paypal_wallet_gateway","button_style"))&&void 0!==t?t:void 0},n}(Ot),Nt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_paylater"},n.prototype.fundingType=function(){return"paylater"},n.prototype.buttonStyle=function(){var t;return null!==(t=C("peachpay_paypal_paylater_gateway","button_style"))&&void 0!==t?t:void 0},n}(Ot),Mt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_credit"},n.prototype.fundingType=function(){return"credit"},n.prototype.buttonStyle=function(){var t;return null!==(t=C("peachpay_paypal_credit_gateway","button_style"))&&void 0!==t?t:void 0},n}(Ot);function Rt(){return r(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,c,u,l;return a(this,(function(a){switch(a.label){case 0:return O("peachpay_paypal_gateways")?(t=C("peachpay_paypal_gateways","client_id"),e=C("peachpay_paypal_gateways","merchant_id"),n=C("peachpay_paypal_gateways","partner_attribution_id"),t&&e&&n?(r=[],O("peachpay_paypal_wallet_gateway")&&r.push(new qt),O("peachpay_paypal_venmo_gateway")&&r.push(new Ct),O("peachpay_paypal_paylater_gateway")&&r.push(new Nt),O("peachpay_paypal_credit_gateway")&&r.push(new Mt),i=function(){r.forEach((function(t){t.unmount()}))},o=function(t){r.forEach((function(e){e.gatewayId()===t&&e.mount()}))},s=function(){return p("#place_order",(function(t){t.style.display="none"}))},c=function(){return p("#place_order",(function(t){t.style.display=""}))},[4,w((function(t){i();var e=r.find((function(e){return e.gatewayId()===t}));e?(o(e.gatewayId()),s()):c()}))]):[2]):[2];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,At({"client-id":t,"merchant-id":e,"data-partner-attribution-id":n,"enable-funding":"venmo",currency:peachpay_checkout_data.cart_details.currency,"data-page-type":"checkout"})];case 3:return(u=a.sent())?[4,Promise.all(r.map((function(t){return t.init(u)})))]:[2];case 4:return a.sent(),[3,6];case 5:return l=a.sent(),console.error("failed to load the PayPal JS SDK script",l),[3,6];case 6:return[2]}}))}))}function zt(){return r(this,void 0,void 0,(function(){var t,e,n,r;return a(this,(function(a){switch(a.label){case 0:return(t=b())?(e=o(location.hash.split("="),2),n=e[0],r=e[1],"#payment_data"===n&&r&&jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),l(),!peachpay_checkout_data.page.is_checkout||peachpay_checkout_data.page.is_order_received?[3,2]:[4,Promise.all([q(t),kt(t),Et(t),Rt()])]):[2];case 1:return a.sent(),[3,3];case 2:peachpay_checkout_data.page.is_order_received&&function(){try{sessionStorage.removeItem(s)}catch(t){}}(),a.label=3;case 3:return"#payment_data"===n&&r&&window.dispatchEvent(new Event("hashchange")),[2]}}))}))}document.addEventListener("DOMContentLoaded",(function(){return r(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2,zt()]}))}))}))})()})();